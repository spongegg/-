
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹¦ç­¾è½¬å¯¼èˆªç«™ä»£ç å·¥å…·</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg: #111827; --card: #1f2937; --text: #f3f4f6; --sub: #9ca3af;
            --primary: #3b82f6; --border: #374151; --success: #059669;
        }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; padding: 40px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 800px; display: flex; flex-direction: column; gap: 20px; }
        
        h1 { text-align: center; margin-bottom: 10px; }
        
        /* ä¸Šä¼ åŒºåŸŸ */
        .upload-box {
            border: 2px dashed var(--border); border-radius: 12px; padding: 40px;
            text-align: center; background: var(--card); cursor: pointer; transition: 0.3s;
        }
        .upload-box:hover { border-color: var(--primary); background: #2d3748; }
        .upload-box i { font-size: 40px; color: var(--sub); margin-bottom: 10px; }
        
        /* æŒ‰é’® */
        button {
            background: var(--primary); color: white; border: none; padding: 12px 24px; 
            border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;
        }
        button:hover { opacity: 0.9; }
        .btn-copy { background: var(--success); width: 100%; }

        /* ç»“æœåŒºåŸŸ */
        textarea {
            width: 100%; height: 300px; background: #0f131a; border: 1px solid var(--border);
            color: #a5b4fc; padding: 15px; border-radius: 8px; font-family: monospace;
            resize: vertical; white-space: pre;
        }

        /* é¢„è§ˆåŒºåŸŸ (ç®€åŒ–ç‰ˆï¼Œä»…å±•ç¤ºç»“æ„) */
        .preview-title { margin-top: 20px; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        #preview { 
            background: var(--bg); padding: 20px; border: 1px solid var(--border); border-radius: 8px;
            max-height: 400px; overflow-y: auto;
        }

        /* æ³¨å…¥çš„æ ·å¼ï¼Œä¿è¯é¢„è§ˆçœ‹èµ·æ¥åƒä½ çš„ç½‘ç«™ */
        .category { margin-bottom: 30px; }
        .cat-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 15px; display: flex; align-items: center; color: white; }
        .cat-title i { margin-right: 10px; color: var(--primary); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 15px; }
        .card { 
            background: var(--card); border: 1px solid var(--border); border-radius: 10px; 
            padding: 12px; text-decoration: none; display: flex; align-items: center; transition: 0.2s;
        }
        .card:hover { border-color: var(--primary); transform: translateY(-2px); }
        .card-icon { width: 32px; height: 32px; margin-right: 12px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
        .card-icon img { width: 100%; height: 100%; border-radius: 4px; object-fit: contain; }
        .card-icon i { font-size: 18px; color: var(--sub); }
        .card-info { overflow: hidden; }
        .card-name { display: block; font-size: 14px; font-weight: bold; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .card-desc { display: block; font-size: 12px; color: var(--sub); margin-top: 2px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ“‘ ä¹¦ç­¾ HTML è½¬æ¢å™¨</h1>
        <p style="text-align:center; color:var(--sub);">è¯·ä¸Šä¼ ä» Chrome / Edge / Firefox å¯¼å‡ºçš„ HTML ä¹¦ç­¾æ–‡ä»¶</p>

        <input type="file" id="fileInput" accept=".html" style="display: none;" onchange="processFile()">
        <div class="upload-box" onclick="document.getElementById('fileInput').click()">
            <i class="fas fa-cloud-upload-alt"></i>
            <p>ç‚¹å‡»ä¸Šä¼  bookmarks.html æ–‡ä»¶</p>
        </div>

        <div id="resultArea" style="display: none;">
            <h3>ç”Ÿæˆä»£ç ï¼š</h3>
            <textarea id="output" readonly></textarea>
            <button class="btn-copy" id="copyBtn" onclick="copyCode()">å¤åˆ¶å…¨éƒ¨ä»£ç </button>

            <h3 class="preview-title">æ•ˆæœé¢„è§ˆï¼š</h3>
            <div id="preview"></div>
        </div>
    </div>

    <script>
        function processFile() {
            const file = document.getElementById('fileInput').files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                parseBookmarks(content);
            };
            reader.readAsText(file);
        }

        function parseBookmarks(htmlContent) {
            // åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿ DOM æ¥è§£æ HTML
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlContent, "text/html");
            
            let finalHtml = "";
            let previewHtml = "";

            // æŸ¥æ‰¾æ‰€æœ‰çš„ DT æ ‡ç­¾ï¼ˆé€šå¸¸åŒ…å« H3 å’Œ DLï¼‰
            // é€»è¾‘ï¼šæ‰¾åˆ° H3 (æ–‡ä»¶å¤¹å)ï¼Œç„¶åæ‰¾å®ƒç´§æ¥ç€çš„ DL (é“¾æ¥åˆ—è¡¨)
            const dts = doc.querySelectorAll('dt');

            dts.forEach(dt => {
                const h3 = dt.querySelector('h3');
                const dl = dt.querySelector('dl');

                // åªæœ‰å½“è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”é‡Œé¢æœ‰é“¾æ¥æ—¶æ‰å¤„ç†
                if (h3 && dl) {
                    const categoryName = h3.textContent;
                    const links = dl.querySelectorAll('a');

                    if (links.length > 0) {
                        // å¼€å§‹æ„å»º Category
                        let catSection = `
        <!-- åˆ†ç±»: ${categoryName} -->
        <div class="category">
            <div class="cat-title"><i class="fas fa-folder-open"></i>&nbsp; ${categoryName}</div>
            <div class="grid">`;

                        links.forEach(link => {
                            const title = link.textContent;
                            const url = link.href;
                            const iconData = link.getAttribute('icon'); // è·å– Base64 å›¾æ ‡
                            
                            // å›¾æ ‡å¤„ç†ï¼šå¦‚æœæœ‰ Base64 åˆ™ç”¨ imgï¼Œå¦åˆ™ç”¨é»˜è®¤å›¾æ ‡
                            let iconHtml = '<i class="fas fa-link"></i>';
                            if (iconData) {
                                iconHtml = `<img src="${iconData}" alt="icon">`;
                            }

                            catSection += `
                <a href="${url}" target="_blank" class="card">
                    <div class="card-icon">${iconHtml}</div>
                    <div class="card-info"><span class="card-name">${title}</span><span class="card-desc">${url.replace(/https?:\/\//, '').split('/')[0]}</span></div>
                </a>`;
                        });

                        catSection += `
            </div>
        </div>`;
                        
                        finalHtml += catSection;
                    }
                }
            });

            // å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°æ–‡ä»¶å¤¹ç»“æ„ï¼ˆæœ‰äº›å¯¼å‡ºç›´æ¥æ˜¯æ‰å¹³çš„é“¾æ¥ï¼‰
            if (finalHtml === "") {
                alert("æœªæ£€æµ‹åˆ°æ ‡å‡†çš„æ–‡ä»¶å¤¹ç»“æ„ï¼Œå°†å°è¯•ç›´æ¥æå–æ‰€æœ‰é“¾æ¥ã€‚");
                // å¤‡ç”¨é€»è¾‘ï¼šæå–æ‰€æœ‰é“¾æ¥åˆ°ä¸€ä¸ªé»˜è®¤åˆ†ç±»
                const links = doc.querySelectorAll('a');
                if(links.length > 0) {
                     finalHtml = `
        <div class="category">
            <div class="cat-title"><i class="fas fa-star"></i>&nbsp; å¯¼å…¥çš„ä¹¦ç­¾</div>
            <div class="grid">`;
                    links.forEach(link => {
                        finalHtml += `
                <a href="${link.href}" target="_blank" class="card">
                    <div class="card-icon"><i class="fas fa-link"></i></div>
                    <div class="card-info"><span class="card-name">${link.textContent}</span></div>
                </a>`;
                    });
                    finalHtml += `
            </div>
        </div>`;
                }
            }

            // è¾“å‡ºç»“æœ
            document.getElementById('output').value = finalHtml;
            document.getElementById('preview').innerHTML = finalHtml;
            document.getElementById('resultArea').style.display = 'block';
            document.querySelector('.upload-box').style.display = 'none'; // éšè—ä¸Šä¼ æ¡†
        }

        function copyCode() {
            const output = document.getElementById('output');
            output.select();
            document.execCommand('copy');
            
            const btn = document.getElementById('copyBtn');
            const originalText = btn.innerText;
            btn.innerText = 'âœ… å¤åˆ¶æˆåŠŸ';
            setTimeout(() => { btn.innerText = originalText; }, 2000);
        }
    </script>
</body>
</html>
